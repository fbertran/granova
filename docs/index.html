<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Graphical Analysis of Variance â€¢ granova</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Graphical Analysis of Variance">
<meta name="description" content="This small collection of functions provides what we call elemental graphics for display of analysis of variance results, David C. Hoaglin, Frederick Mosteller and John W. Tukey (1991, ISBN:978-0-471-52735-0), Paul R. Rosenbaum (1989) &lt;doi:10.2307/2684513&gt;, Robert M. Pruzek and James E. Helmreich &lt;https://jse.amstat.org/v17n1/helmreich.html&gt;. The term elemental derives from the fact that each function is aimed at construction of graphical displays that afford direct visualizations of data with respect to the fundamental questions that drive the particular analysis of variance methods. These functions can be particularly helpful for students and non-statistician analysts. But these methods should be quite generally helpful for work-a-day applications of all kinds, as they can help to identify outliers, clusters or patterns, as well as highlight the role of non-linear transformations of data.">
<meta property="og:description" content="This small collection of functions provides what we call elemental graphics for display of analysis of variance results, David C. Hoaglin, Frederick Mosteller and John W. Tukey (1991, ISBN:978-0-471-52735-0), Paul R. Rosenbaum (1989) &lt;doi:10.2307/2684513&gt;, Robert M. Pruzek and James E. Helmreich &lt;https://jse.amstat.org/v17n1/helmreich.html&gt;. The term elemental derives from the fact that each function is aimed at construction of graphical displays that afford direct visualizations of data with respect to the fundamental questions that drive the particular analysis of variance methods. These functions can be particularly helpful for students and non-statistician analysts. But these methods should be quite generally helpful for work-a-day applications of all kinds, as they can help to identify outliers, clusters or patterns, as well as highlight the role of non-linear transformations of data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">granova</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fbertran/granova/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="granova">granova<a class="anchor" aria-label="anchor" href="#granova"></a>
</h1></div>
<p><a href="https://doi.org/10.32614/CRAN.package.granova" class="external-link uri">https://doi.org/10.32614/CRAN.package.granova</a></p>
<!-- badges: start -->

<p>This small collection of functions provides what we call elemental graphics for display of analysis of variance results, David C. Hoaglin, Frederick Mosteller and John W. Tukey (1991, <a href="ISBN:978-0-471-52735-0" class="uri">ISBN:978-0-471-52735-0</a>), Paul R. Rosenbaum (1989) <a href="doi:10.2307/2684513" class="uri">doi:10.2307/2684513</a>, Robert M. Pruzek and James E. Helmreich <a href="https://jse.amstat.org/v17n1/helmreich.html" class="external-link uri">https://jse.amstat.org/v17n1/helmreich.html</a>.</p>
<p>The term elemental derives from the fact that each function is aimed at construction of graphical displays that afford direct visualizations of data with respect to the fundamental questions that drive the particular analysis of variance methods. These functions can be particularly helpful for students and non-statistician analysts. But these methods should be quite generally helpful for work-a-day applications of all kinds, as they can help to identify outliers, clusters or patterns, as well as highlight the role of non-linear transformations of data.</p>
<p>This package has been written by Robert M. Pruzek and James E. Helmreich. Frederic Bertrand is now the maintainer of package and has been doing several code fixes and improvements to the package.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of granova from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"granova"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of granova from <a href="https://github.com" class="external-link">github</a> like so:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"fbertran/granova"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/granova/">granova</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">arousal</span><span class="op">)</span></span></code></pre></div>
<p>Drug A</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## basic example code</span></span>
<span><span class="fu"><a href="reference/granova.1w.html">granova.1w</a></span><span class="op">(</span><span class="va">arousal</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, h.rng <span class="op">=</span> <span class="fl">1.6</span>, v.rng <span class="op">=</span> <span class="fl">0.5</span>, top.dot <span class="op">=</span> <span class="fl">.35</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-DrugA-1.png" alt="plot of chunk DrugA" width="100%"><p class="caption">
plot of chunk DrugA
</p>
</div>
<pre><code><span><span class="co">#&gt; $grandsum</span></span>
<span><span class="co">#&gt;     Grandmean        df.bet       df.with        MS.bet       MS.with</span></span>
<span><span class="co">#&gt;         22.35          1.00         18.00         73.73          6.86</span></span>
<span><span class="co">#&gt;        F.stat        F.prob SS.bet/SS.tot</span></span>
<span><span class="co">#&gt;         10.75          0.00          0.37</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; $stats</span></span>
<span><span class="co">#&gt;         Size Contrast Coef Wt'd Mean  Mean Trim'd Mean Var. St. Dev.</span></span>
<span><span class="co">#&gt; Placebo   10         -1.92     20.43 20.43       20.30 5.83     2.41</span></span>
<span><span class="co">#&gt; Drug.A    10          1.92     24.27 24.27       24.45 7.89     2.81</span></span></code></pre>
<div id="section" class="section level25">
<p class="heading"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">anorexia</span>, package<span class="op">=</span><span class="st">"MASS"</span><span class="op">)</span></span>
<span><span class="va">wt.gain</span> <span class="op">&lt;-</span> <span class="va">anorexia</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">anorexia</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="reference/granova.1w.html">granova.1w</a></span><span class="op">(</span><span class="va">wt.gain</span>, group <span class="op">=</span> <span class="va">anorexia</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, size.line <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-anorexia-1.png" alt="plot of chunk anorexia" width="100%"><p class="caption">
plot of chunk anorexia
</p>
</div>
<pre><code><span><span class="co">#&gt; $grandsum</span></span>
<span><span class="co">#&gt;     Grandmean        df.bet       df.with        MS.bet       MS.with</span></span>
<span><span class="co">#&gt;          2.76          2.00         69.00        307.32         56.68</span></span>
<span><span class="co">#&gt;        F.stat        F.prob SS.bet/SS.tot</span></span>
<span><span class="co">#&gt;          5.42          0.01          0.14</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; $stats</span></span>
<span><span class="co">#&gt;      Size Contrast Coef Wt'd Mean  Mean Trim'd Mean  Var. St. Dev.</span></span>
<span><span class="co">#&gt; Cont   26         -3.21     -0.49 -0.45       -1.16 63.82     7.99</span></span>
<span><span class="co">#&gt; CBT    29          0.24      3.63  3.01        1.80 53.41     7.31</span></span>
<span><span class="co">#&gt; FT     17          4.50      5.15  7.26        7.91 51.23     7.16</span></span></code></pre>
<div id="section-1" class="section level26">
<p class="heading"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">poison</span><span class="op">)</span></span></code></pre></div>
<p>Note violation of constant variance across groups in following graphic.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/granova.1w.html">granova.1w</a></span><span class="op">(</span><span class="va">poison</span><span class="op">$</span><span class="va">SurvTime</span>, group <span class="op">=</span> <span class="va">poison</span><span class="op">$</span><span class="va">Group</span>, ylab <span class="op">=</span> <span class="st">"Survival Time"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-violation%20of%20constant%20variance%20across%20groups-1.png" alt="plot of chunk violation of constant variance across groups" width="100%"><p class="caption">
plot of chunk violation of constant variance across groups
</p>
</div>
<pre><code><span><span class="co">#&gt; $grandsum</span></span>
<span><span class="co">#&gt;     Grandmean        df.bet       df.with        MS.bet       MS.with</span></span>
<span><span class="co">#&gt;          0.48         11.00         36.00          0.20          0.02</span></span>
<span><span class="co">#&gt;        F.stat        F.prob SS.bet/SS.tot</span></span>
<span><span class="co">#&gt;          9.01          0.00          0.73</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; $stats</span></span>
<span><span class="co">#&gt;    Size Contrast Coef Wt'd Mean Mean Trim'd Mean Var. St. Dev.</span></span>
<span><span class="co">#&gt; 3     4         -0.27      0.21 0.21        0.21 0.00     0.02</span></span>
<span><span class="co">#&gt; 9     4         -0.24      0.23 0.23        0.23 0.00     0.01</span></span>
<span><span class="co">#&gt; 2     4         -0.16      0.32 0.32        0.32 0.01     0.08</span></span>
<span><span class="co">#&gt; 12    4         -0.15      0.32 0.32        0.32 0.00     0.03</span></span>
<span><span class="co">#&gt; 6     4         -0.14      0.33 0.33        0.33 0.00     0.05</span></span>
<span><span class="co">#&gt; 8     4         -0.10      0.38 0.38        0.38 0.00     0.06</span></span>
<span><span class="co">#&gt; 1     4         -0.07      0.41 0.41        0.41 0.00     0.07</span></span>
<span><span class="co">#&gt; 7     4          0.09      0.57 0.57        0.57 0.02     0.16</span></span>
<span><span class="co">#&gt; 10    4          0.13      0.61 0.61        0.61 0.01     0.11</span></span>
<span><span class="co">#&gt; 11    4          0.19      0.67 0.67        0.67 0.07     0.27</span></span>
<span><span class="co">#&gt; 5     4          0.34      0.81 0.81        0.81 0.11     0.34</span></span>
<span><span class="co">#&gt; 4     4          0.40      0.88 0.88        0.88 0.03     0.16</span></span></code></pre>
<p>RateSurvTime = SurvTime^-1</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/granova.1w.html">granova.1w</a></span><span class="op">(</span><span class="va">poison</span><span class="op">$</span><span class="va">RateSurvTime</span>, group <span class="op">=</span> <span class="va">poison</span><span class="op">$</span><span class="va">Group</span>, </span>
<span>ylab <span class="op">=</span> <span class="st">"Survival Rate = Inverse of Survival Time"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-RateSurvTime-1.png" alt="plot of chunk RateSurvTime" width="100%"><p class="caption">
plot of chunk RateSurvTime
</p>
</div>
<pre><code><span><span class="co">#&gt; $grandsum</span></span>
<span><span class="co">#&gt;     Grandmean        df.bet       df.with        MS.bet       MS.with</span></span>
<span><span class="co">#&gt;          2.62         11.00         36.00          5.17          0.24</span></span>
<span><span class="co">#&gt;        F.stat        F.prob SS.bet/SS.tot</span></span>
<span><span class="co">#&gt;         21.53          0.00          0.87</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; $stats</span></span>
<span><span class="co">#&gt;    Size Contrast Coef Wt'd Mean Mean Trim'd Mean Var. St. Dev.</span></span>
<span><span class="co">#&gt; 4     4         -1.46      1.16 1.16        1.16 0.04     0.20</span></span>
<span><span class="co">#&gt; 5     4         -1.23      1.39 1.39        1.39 0.31     0.55</span></span>
<span><span class="co">#&gt; 10    4         -0.93      1.69 1.69        1.69 0.13     0.36</span></span>
<span><span class="co">#&gt; 11    4         -0.92      1.70 1.70        1.70 0.49     0.70</span></span>
<span><span class="co">#&gt; 7     4         -0.76      1.86 1.86        1.86 0.24     0.49</span></span>
<span><span class="co">#&gt; 1     4         -0.14      2.49 2.49        2.49 0.25     0.50</span></span>
<span><span class="co">#&gt; 8     4          0.09      2.71 2.71        2.71 0.17     0.42</span></span>
<span><span class="co">#&gt; 6     4          0.41      3.03 3.03        3.03 0.18     0.42</span></span>
<span><span class="co">#&gt; 12    4          0.47      3.09 3.09        3.09 0.06     0.24</span></span>
<span><span class="co">#&gt; 2     4          0.65      3.27 3.27        3.27 0.68     0.82</span></span>
<span><span class="co">#&gt; 9     4          1.64      4.26 4.26        4.26 0.06     0.23</span></span>
<span><span class="co">#&gt; 3     4          2.18      4.80 4.80        4.80 0.28     0.53</span></span></code></pre>
<p>Nonparametric version: RateSurvTime ranked and rescaled to be comparable to RateSurvTime; note labels as well as residual (rug) plot below.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/granova.1w.html">granova.1w</a></span><span class="op">(</span><span class="va">poison</span><span class="op">$</span><span class="va">RankRateSurvTime</span>, group <span class="op">=</span> <span class="va">poison</span><span class="op">$</span><span class="va">Group</span>, </span>
<span>ylab <span class="op">=</span> <span class="st">"Ranked and Centered Survival Rates"</span>,</span>
<span>main <span class="op">=</span> <span class="st">"One-way ANOVA display, poison data (ignoring 2-way set-up)"</span>, </span>
<span>res <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-Nonparametric%20version-1.png" alt="plot of chunk Nonparametric version" width="100%"><p class="caption">
plot of chunk Nonparametric version
</p>
</div>
<pre><code><span><span class="co">#&gt; $grandsum</span></span>
<span><span class="co">#&gt;     Grandmean        df.bet       df.with        MS.bet       MS.with</span></span>
<span><span class="co">#&gt;          2.49         11.00         36.00          3.70          0.19</span></span>
<span><span class="co">#&gt;        F.stat        F.prob SS.bet/SS.tot</span></span>
<span><span class="co">#&gt;         19.18          0.00          0.85</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; $stats</span></span>
<span><span class="co">#&gt;    Size Contrast Coef Wt'd Mean Mean Trim'd Mean Var. St. Dev.</span></span>
<span><span class="co">#&gt; 4     4         -1.38      1.11 1.11        1.11 0.03     0.18</span></span>
<span><span class="co">#&gt; 5     4         -1.13      1.36 1.36        1.36 0.28     0.53</span></span>
<span><span class="co">#&gt; 10    4         -0.82      1.67 1.67        1.67 0.10     0.31</span></span>
<span><span class="co">#&gt; 11    4         -0.80      1.69 1.69        1.69 0.50     0.71</span></span>
<span><span class="co">#&gt; 7     4         -0.67      1.81 1.81        1.81 0.24     0.49</span></span>
<span><span class="co">#&gt; 1     4         -0.10      2.39 2.39        2.39 0.30     0.55</span></span>
<span><span class="co">#&gt; 8     4          0.23      2.72 2.72        2.72 0.19     0.44</span></span>
<span><span class="co">#&gt; 6     4          0.55      3.04 3.04        3.04 0.18     0.42</span></span>
<span><span class="co">#&gt; 12    4          0.61      3.09 3.09        3.09 0.05     0.22</span></span>
<span><span class="co">#&gt; 2     4          0.66      3.15 3.15        3.15 0.39     0.62</span></span>
<span><span class="co">#&gt; 9     4          1.29      3.78 3.78        3.78 0.03     0.16</span></span>
<span><span class="co">#&gt; 3     4          1.55      4.04 4.04        4.04 0.03     0.16</span></span></code></pre>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=granova" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/fbertran/granova/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/fbertran/granova/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing granova</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Frederic Bertrand <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0837-8281" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Robert M. Pruzek <br><small class="roles"> Author </small>   </li>
<li>James E. Helmreich <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://doi.org/10.32614/CRAN.package.granova" class="external-link"><img src="https://img.shields.io/badge/doi-10.32614/CRAN.package.granova-blue.svg"></a></li>
<li><a href="https://CRAN.R-project.org/package=granova" class="external-link"><img src="https://www.r-pkg.org/badges/version/granova" alt="CRAN status"></a></li>
<li><a href="https://github.com/fbertran/granova/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/fbertran/granova/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Frederic Bertrand, Robert M. Pruzek, James E. Helmreich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
